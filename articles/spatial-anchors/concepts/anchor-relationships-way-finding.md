---
title: 定位点关系和方式-查找
description: 了解定位点关系背后的概念模型。 了解如何在空间内连接定位点，以及如何使用附近的 API 来实现一种查找方案。
author: ramonarguelles
manager: vriveras
services: azure-spatial-anchors
ms.author: rgarcia
ms.date: 02/24/2019
ms.topic: conceptual
ms.service: azure-spatial-anchors
ms.openlocfilehash: 13c85dff40e266287d893d9e45b32a66a33f027e
ms.sourcegitcommit: ac4a365a6c6ffa6b6a5fbca1b8f17fde87b4c05e
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/10/2020
ms.locfileid: "83006023"
---
# <a name="anchor-relationships-and-way-finding-in-azure-spatial-anchors"></a>定位关系和在 Azure 空间锚中查找的方式

通过使用定位点关系，你可以在一个空间中创建连接的定位点，然后提出如下所示的问题：

* 是否存在附近的定位点？
* 它们有多远？

## <a name="examples"></a>示例

您可以在以下情况下使用连接的锚点：

* 辅助角色需要完成涉及访问工业工厂中各种位置的任务。 工厂在每个位置都有空间锚。 HoloLens 或移动应用可帮助引导辅助角色从一个位置到下一个位置。 应用首先会询问附近的空间锚，然后将辅助角色引导到下一个位置。 应用程序直观地显示与下一位置的一般方向和距离。

* 博物馆在公共显示器上创建空间锚。 这些定位点共同构成了一小时的博物馆基本公共显示器。 在公共显示器上，访问者可以在其移动设备上打开博物馆的混合现实应用。 然后，它们将手机点置于空间周围，以查看与该教程上的其他公共显示器之间的一般方向和距离。 当用户经历公共显示时，应用程序会更新一般方向和距离，以帮助用户的指导。

## <a name="set-up-way-finding"></a>设置方法-查找

使用直线方向和锚点之间的距离的应用使用*方法查找*提供指导。 方法-查找不同于轮流导航。 在轮流导航中，用户通过门和地面之间的指导。 通过方法查找，用户获取有关目标的一般方向的提示。 但是，对空间的推理或了解还有助于用户在结构和目标之间导航。

若要构建一个方法查找体验，请首先为体验准备空间，并开发用户将与之交互的应用。 概念性步骤如下：

1. **规划空间**：确定空间内的哪些位置将是查找体验的一部分。 在我们的方案中，工厂主管或博物馆浏览协调员可能决定要将哪些位置包括在查找体验中。
2. **连接锚点**：访问所选位置以创建空间锚。 可以在最终用户应用的管理模式下或在其他应用中完全执行此操作。 将每个定位点连接或关联到其他定位点。 服务维护这些关系。
3. **开始最终用户体验**：用户运行应用以定位定位点，该定位点可以位于任何所选位置。 你的整体设计应确定用户可以进入体验的位置。
4. **查找附近的定位点**：用户查找定位点后，应用可以请求附近的定位点。 此过程将返回设备和这些定位点之间的姿势。
5. **指导用户**：应用可将姿势用于每个定位点，为用户的一般方向和距离指定指导。 例如，应用中的相机源可能会显示一个图标和箭头来表示每个潜在目标，如下图所示。
6. **优化指导**：当用户演练时，应用程序可以定期计算设备和目标定位点之间的新姿势。 应用会继续优化帮助用户到达目标的指导提示。

    ![应用如何显示方法查找指南的示例](./media/meeting-spot.png)

## <a name="connect-anchors"></a>连接锚

若要构建方法查找体验，首先需要将定位点置于所选位置。 在本部分中，我们将假定应用的管理员已经完成了此项工作。

### <a name="connect-anchors-in-a-single-session"></a>在单个会话中连接锚点

连接锚点：

1. 使用 CloudSpatialAnchorSession 遍历第一个位置并创建定位点 A。
2. 转到第二个位置。 基础 MR/AR 平台跟踪移动。
3. 使用相同的 CloudSpatialAnchorSession 创建定位点 B。 当前已连接锚点 A 和 B。 空间锚定服务维护此关系。
4. 对于剩余的定位点，继续执行该过程。

### <a name="connect-anchors-in-multiple-sessions"></a>在多个会话中连接锚点

可以通过多个会话连接空间锚。 使用此方法，你可以一次创建并连接一些定位点，然后再创建并连接多个定位点。

若要连接多个会话的定位点：

1. 应用程序在一个 CloudSpatialAnchorSession 中创建了一些定位点。
2. 在其他时间，应用程序使用新的 CloudSpatialAnchorSession 查找其中一个定位点（例如，定位 A）。
3. 转到新位置。 底层混合现实或扩充现实平台跟踪移动。
4. 使用相同的 CloudSpatialAnchorSession 创建定位点 C。 当前已连接锚点 A、B 和 C。 空间锚定服务维护此关系。

你可以继续执行此过程，以便在一段时间内更多锚定和更多会话。

### <a name="verify-anchor-connections"></a>验证定位点连接

应用程序可以通过对附近的定位点发出查询来验证是否已连接两个定位点，这是`NearAnchorCriteria`通过在`CloudSpatialAnchorWatcher`上设置的来实现的。 当查询的结果包含目标定位点时，将验证定位点连接。 如果定位点未连接，应用可以尝试再次连接。

下面是定位点可能无法连接的一些原因：

* 在连接锚点的过程中，根本混合现实或增加的现实平台会丢失跟踪。
* 由于在与空间锚定服务通信的过程中出现网络错误，无法持久化锚点连接。

### <a name="find-sample-code"></a>查找示例代码

若要查找演示如何连接定位点和执行附近查询的示例代码，请参阅[空间锚的示例应用](https://github.com/Azure/azure-spatial-anchors-samples)。
